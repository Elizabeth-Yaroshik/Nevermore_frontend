<header style="
  background-color:#6750A4;
  color:white;
  padding:8px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 2px 10px rgba(0,0,0,0.1);
  height:80px;
  position:sticky;
  top:0;
  z-index:100;
  font-family:'Playfair Display',serif;
">
  <div style="display:flex;align-items:center;gap:12px;">
    <img src='../resources/logo.png' alt='logo' style='width:60px;height:60px;object-fit:contain;'>
    <div style="font-size:1.8rem;font-weight:700;display:flex;align-items:center;">
      <span style='color:#471414;font-size:2.2rem;'>N</span>evermore
    </div>
  </div>

  <div style="flex:1;max-width:500px;margin:0 20px;">
    <div style="display:flex;align-items:center;background:rgba(255,255,255,0.1);border-radius:20px;padding-right:10px;">
      <input type="text" 
             id="headerSearchInput" 
             placeholder="–ü–æ–∏—Å–∫ –∫–Ω–∏–≥, –∞–≤—Ç–æ—Ä–æ–≤..." 
             style="
                flex:1;
                padding:10px 15px;
                border:none;
                background:none;
                color:white;
                font-size:1rem;
                outline:none;
             ">
      <button id="headerSearchBtn" style="
                background:none;
                border:none;
                color:white;
                cursor:pointer;
                padding:10px;
                display:flex;
                align-items:center;
                justify-content:center;
                opacity:0.8;
                transition:opacity 0.3s;
             "
             onmouseover="this.style.opacity='1'"
             onmouseout="this.style.opacity='0.8'">
        <i class="fas fa-search"></i>
      </button>
    </div>
  </div>

  <!-- –ê–í–ê–¢–ê–† –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø -->
  <div onclick="location.href='../profile/profile.html'" style="cursor:pointer;">
    <img id="headerAvatar" src="../resources/Icon.png" alt="–ü—Ä–æ—Ñ–∏–ª—å" style="
      width:40px;
      height:40px;
      border-radius:50%;
      object-fit:cover;
    ">
  </div>
</header>

<script>
// –í–ê–ñ–ù–û: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –ü–û–°–õ–ï Search/search.js
// —á—Ç–æ–±—ã –∏–º–µ—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏

document.addEventListener("DOMContentLoaded", function() {
  console.log('üîß Header –∑–∞–≥—Ä—É–∂–µ–Ω - –ø–æ–∏—Å–∫ FIX –≤–µ—Ä—Å–∏—è');
  
  // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞
  const savedAvatar = localStorage.getItem("avatar");
  if (savedAvatar) {
    document.getElementById("headerAvatar").src = savedAvatar;
  }
  
  // ========== –§–ò–ö–° –ü–û–ò–°–ö–ê –ü–û ENTER ==========
  const searchInput = document.getElementById('headerSearchInput');
  const searchBtn = document.getElementById('headerSearchBtn');
  
  if (!searchInput) {
    console.error('‚ùå –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!');
    return;
  }
  
  console.log('‚úÖ –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ –Ω–∞–π–¥–µ–Ω–æ, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏...');
  
  // 1. –£–î–ê–õ–ò–¢–¨ –í–°–ï –°–¢–ê–†–´–ï –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤)
  const newInput = searchInput.cloneNode(true);
  searchInput.parentNode.replaceChild(newInput, searchInput);
  
  const newBtn = searchBtn.cloneNode(true);
  searchBtn.parentNode.replaceChild(newBtn, searchBtn);
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
  const fixedSearchInput = document.getElementById('headerSearchInput');
  const fixedSearchBtn = document.getElementById('headerSearchBtn');
  
  // 2. –ü–†–û–°–¢–û–ô –†–ê–ë–û–ß–ò–ô –ü–û–ò–°–ö –ü–û ENTER
  fixedSearchInput.addEventListener('keydown', function(e) {
    console.log('‚å®Ô∏è –ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞ –≤ –ø–æ–∏—Å–∫–µ:', e.key);
    
    if (e.key === 'Enter') {
      e.preventDefault(); // –í–∞–∂–Ω–æ!
      e.stopPropagation(); // –í–∞–∂–Ω–æ!
      console.log('üîç ENTER –ó–ê–•–í–ê–ß–ï–ù! –ó–Ω–∞—á–µ–Ω–∏–µ:', this.value);
      
      const query = this.value.trim();
      if (!query) {
        alert('–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞');
        return;
      }
      
      console.log('üöÄ –í—ã–ø–æ–ª–Ω—è—é –ø–æ–∏—Å–∫:', query);
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å
      sessionStorage.setItem('lastSearchQuery', query);
      
      // –ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
      window.location.href = '../Search/search-results.html?q=' + encodeURIComponent(query);
    }
  });
  
  // 3. –ö–ù–û–ü–ö–ê –ü–û–ò–°–ö–ê
  fixedSearchBtn.addEventListener('click', function(e) {
    e.preventDefault();
    e.stopPropagation();
    
    const query = fixedSearchInput.value.trim();
    if (!query) {
      alert('–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞');
      fixedSearchInput.focus();
      return;
    }
    
    console.log('üîç –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ –Ω–∞–∂–∞—Ç–∞:', query);
    
    sessionStorage.setItem('lastSearchQuery', query);
    window.location.href = '../Search/search-results.html?q=' + encodeURIComponent(query);
  });
  
  // 4. –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –µ—Å–ª–∏ –æ–Ω–æ –º–µ—à–∞–µ—Ç (–≤—Ä–µ–º–µ–Ω–Ω–æ)
  fixedSearchInput.addEventListener('keydown', function(e) {
    // –ï—Å–ª–∏ SearchEngine –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç Enter, –æ—Ç–∫–ª—é—á–∞–µ–º –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
    if (e.key === 'Enter') {
      // –û—Ç–º–µ–Ω—è–µ–º –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
      return false;
    }
  }, true); // true = capture phase, —á—Ç–æ–±—ã –Ω–∞—à –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –±—ã–ª –ø–µ—Ä–≤—ã–º
  
  console.log('‚úÖ –ü–æ–∏—Å–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –¢–µ—Å—Ç: –≤–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç –∏ –Ω–∞–∂–º–∏ Enter');
});

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ (–º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –∏–∑ –¥—Ä—É–≥–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤)
window.performHeaderSearch = function() {
  const searchInput = document.getElementById('headerSearchInput');
  if (!searchInput) return;
  
  const query = searchInput.value.trim();
  if (!query) {
    alert('–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞');
    return;
  }
  
  sessionStorage.setItem('lastSearchQuery', query);
  window.location.href = '../Search/search-results.html?q=' + encodeURIComponent(query);
};
</script>