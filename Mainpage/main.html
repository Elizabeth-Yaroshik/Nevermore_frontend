<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nevermore - Главная</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../Mainpage/main.css">
    <script src="../Mainpage/main.js"></script>
</head>
<!-- Добавить ПЕРЕД main.js -->
<script src="../assets/js/global-logger.js" defer></script>
<script src="../assets/js/api-logger.js" defer></script>
<script src="main-logger.js" defer></script>
<script src="main.js" defer></script>
<body>
    <div id="toastContainer" class="toast-container"></div>

    <div id="header"></div>

    <div class="container">
        <div id="sidebar"></div>

        <!-- Main Content -->
        <div class="main-content-wrapper">
            <div class="main-content">
                <div class="books-section">
                    <h2 class="clubs-title">
                        Мои книги
                    </h2>
                    
                    <div class="horizontal-scroll-container">
                        <div class="books-scroll" id="recent-books">
                            <!-- Книга 1 с data-id для перехода на страницу книги -->
                            <div class="book-card" data-book-id="1" data-title="Преступление и наказание" data-author="Ф.М. Достоевский">
                                <div class="book-cover" style="background-color: #6750A4; opacity: 0.6;">
                                    ПРЕСТУПЛЕНИЕ И НАКАЗАНИЕ
                                </div>
                                <div class="book-title">Преступление и наказание</div>
                                <div class="book-author">Ф.М. Достоевский</div>
                                <div class="progress-bar">
                                    <div class="progress" style="width: 65%"></div>
                                </div>
                            </div>
                            
                            <!-- Книга 2 -->
                            <div class="book-card" data-book-id="3" data-title="Мастер и Маргарита" data-author="М.А. Булгаков">
                                <div class="book-cover" style="background-color: #6750A4; opacity: 0.6;">
                                    МАСТЕР И МАРГАРИТА
                                </div>
                                <div class="book-title">Мастер и Маргарита</div>
                                <div class="book-author">М.А. Булгаков</div>
                                <div class="progress-bar">
                                    <div class="progress" style="width: 80%"></div>
                                </div>
                            </div>
                            
                            <!-- Книга 3 -->
                            <div class="book-card" data-book-id="2" data-title="Над пропастью во ржи" data-author="Джером Сэлинджер">
                                <div class="book-cover" style="background-color: #6750A4; opacity: 0.6;">
                                    НАД ПРОПАСТЬЮ ВО РЖИ
                                </div>
                                <div class="book-title">Над пропастью во ржи</div>
                                <div class="book-author">Джером Сэлинджер</div>
                                <div class="progress-bar">
                                    <div class="progress" style="width: 33%"></div>
                                </div>
                            </div>
                            
                            <!-- Книга 4 -->
                            <div class="book-card" data-book-id="4" data-title="1984" data-author="Джордж Оруэлл">
                                <div class="book-cover" style="background-color: #6750A4; opacity: 0.6;">
                                    1984
                                </div>
                                <div class="book-title">1984</div>
                                <div class="book-author">Джордж Оруэлл</div>
                                <div class="progress-bar">
                                    <div class="progress" style="width: 45%"></div>
                                </div>
                            </div>
                            
                            <!-- Книга 5 -->
                            <div class="book-card" data-book-id="5" data-title="Тихий Дон" data-author="М.А. Шолохов">
                                <div class="book-cover" style="background-color: #6750A4; opacity: 0.6;">
                                    ТИХИЙ ДОН
                                </div>
                                <div class="book-title">Тихий Дон</div>
                                <div class="book-author">М.А. Шолохов</div>
                                <div class="progress-bar">
                                    <div class="progress" style="width: 30%"></div>
                                </div>
                            </div>
                            
                            <!-- Книга 6 -->
                            <div class="book-card" data-book-id="6" data-title="Анна Каренина" data-author="Л.Н. Толстой">
                                <div class="book-cover" style="background-color: #6750A4; opacity: 0.6;">
                                    АННА КАРЕНИНА
                                </div>
                                <div class="book-title">Анна Каренина</div>
                                <div class="book-author">Л.Н. Толстой</div>
                                <div class="progress-bar">
                                    <div class="progress" style="width: 75%"></div>
                                </div>
                            </div>
                            
                            <!-- Книга 7 -->
                            <div class="book-card" data-book-id="7" data-title="Горе от ума" data-author="А.С. Грибоедов">
                                <div class="book-cover" style="background-color: #6750A4; opacity: 0.6;">
                                    ГОРЕ ОТ УМА
                                </div>
                                <div class="book-title">Горе от ума</div>
                                <div class="book-author">А.С. Грибоедов</div>
                                <div class="progress-bar">
                                    <div class="progress" style="width: 100%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Book Clubs Section -->
                <div class="clubs-section">
                    <h2 class="clubs-title">
                        Мои читательские клубы
                    </h2>
                    
                    <div class="clubs-list">
                        <!-- Клуб 1 с data-id для перехода на страницу клуба -->
                        <div class="club-item" data-club-id="1" data-club-name="Классика навсегда">
                            <img src="../resources/Ellipse 2.png" alt="Nevermore" class="club-icon">
                            <div class="club-info">
                                <div class="club-name">Классика навсегда</div>
                                <div class="club-members">24 участника</div>
                            </div>
                            <div class="club-notifications">3+</div>
                        </div>
                        
                        <!-- Клуб 2 -->
                        <div class="club-item" data-club-id="2" data-club-name="Мировая литература">
                            <img src="../resources/Ellipse 2.png" alt="Nevermore" class="club-icon">
                            <div class="club-info">
                                <div class="club-name">Мировая литература</div>
                                <div class="club-members">42 участника</div>
                            </div>
                            <div class="club-notifications">12+</div>
                        </div>
                        
                        <!-- Клуб 3 -->
                        <div class="club-item" data-club-id="3" data-club-name="Современная проза">
                            <img src="../resources/Ellipse 2.png" alt="Nevermore" class="club-icon">
                            <div class="club-info">
                                <div class="club-name">Современная проза</div>
                                <div class="club-members">18 участников</div>
                            </div>
                            <div class="club-notifications">1+</div>
                        </div>
                        
                        <!-- Клуб 4 -->
                        <div class="club-item" data-club-id="4" data-club-name="Драматургия">
                            <img src="../resources/Ellipse 2.png" alt="Nevermore" class="club-icon">
                            <div class="club-info">
                                <div class="club-name">Драматургия</div>
                                <div class="club-members">15 участников</div>
                            </div>
                            <div class="club-notifications">0+</div>
                        </div>
                        
                        <!-- Клуб 5 -->
                        <div class="club-item" data-club-id="5" data-club-name="Олени навсегда">
                            <img src="../resources/Ellipse 2.png" alt="Nevermore" class="club-icon">
                            <div class="club-info">
                                <div class="club-name">Научная фантастика</div>
                                <div class="club-members">28 участника</div>
                            </div>
                            <div class="club-notifications">52+</div>
                        </div>
                        
                        <!-- Клуб 6 -->
                        <div class="club-item" data-club-id="6" data-club-name="Оленьи рассказы">
                            <img src="../resources/Ellipse 2.png" alt="Nevermore" class="club-icon">
                            <div class="club-info">
                                <div class="club-name">Фэнтези и магия</div>
                                <div class="club-members">35 участников</div>
                            </div>
                            <div class="club-notifications">66+</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Goals Sidebar -->
            <div class="goals-sidebar">
                <!-- Карточка с целью (переход на страницу статистики) -->
                <div class="goal-card" id="annual-goal" data-goal-type="annual">
                    <div class="goal-title">Моя ежегодная цель</div>
                    <div class="goal-box">
                         <img src="../resources/edit.png" alt="Nevermore" class="time-icon">
                         <div class="goal-value">12 книг</div>
                     </div>
                    <div class="goal-subtitle">Установите свою цель</div>
                </div>
                
                <!-- Карточка с временем чтения (переход на страницу таймера/статистики) -->
                <div class="time-card" id="weekly-reading" data-goal-type="stats">
                    <div class="time-title">Время чтения за эту неделю</div>
                    <div class="reading-time">
                        <img src="../resources/alarm.png" alt="Nevermore" class="time-icon">
                        <div class="time-value">05h:42min</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="mobile-nav"></div>
    
    <!-- Скрипты для загрузки меню -->
    <script>
      fetch("../menu_samples/sidebar.html")
        .then(r => r.text())
        .then(html => {
          document.getElementById("sidebar").innerHTML = html;
        })
        .catch(err => console.error('Error loading sidebar:', err));
    </script>
    <script>
     fetch("../menu_samples/header.html")
      .then(r => r.text())
      .then(h => document.getElementById("header").innerHTML = h); 
    </script>
    <script>
      fetch("../menu_samples/mobile-nav.html")
        .then(r => r.text())
        .then(html => {
          document.getElementById("mobile-nav").innerHTML = html;
        })
        .catch(err => console.error('Error loading mobile navigation:', err));
    </script>
    <script src="../menu_samples/menu_loader.js"></script>
    
    <!-- Скрипт для обработки кликов по книгам, клубам и таймеру -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
          
          // ====== ОБРАБОТЧИК ДЛЯ КНИГ ======
          document.querySelectorAll('.book-card').forEach(card => {
              card.addEventListener('click', function(event) {
                  event.preventDefault();
                  
                  const bookId = this.getAttribute('data-book-id');
                  const bookTitle = this.getAttribute('data-title');
                  const bookAuthor = this.getAttribute('data-author');
                  
                  if (bookId) {
                      // Сохраняем данные книги в localStorage для использования на странице книги
                      localStorage.setItem('currentBook', JSON.stringify({
                          id: bookId,
                          title: bookTitle,
                          author: bookAuthor
                      }));
                      
                      // Переход на страницу книги с передачей ID
                      window.location.href = `../Bookpage/book.html?id=${bookId}`;
                  }
              });
          });
          
          // ====== ОБРАБОТЧИК ДЛЯ КЛУБОВ ======
          document.querySelectorAll('.club-item').forEach(club => {
              club.addEventListener('click', function(event) {
                  event.preventDefault();
                  
                  const clubId = this.getAttribute('data-club-id');
                  const clubName = this.getAttribute('data-club-name');
                  
                  if (clubId) {
                      // Сохраняем данные клуба в localStorage
                      localStorage.setItem('currentClub', JSON.stringify({
                          id: clubId,
                          name: clubName
                      }));
                      
                      // Переход на страницу клуба с передачей ID
                      window.location.href = `../Bookclub/club.html?id=${clubId}&name=${encodeURIComponent(clubName)}`;
                  }
              });
          });
          
          // ====== ОБРАБОТЧИК ДЛЯ ЦЕЛЕЙ ======
          document.getElementById('annual-goal').addEventListener('click', function(event) {
              event.preventDefault();
              // Переход на страницу статистики целей
              window.location.href = `../Stats/stats.html?type=goals`;
          });
          
          // ====== ОБРАБОТЧИК ДЛЯ ТАЙМЕРА ======
          document.getElementById('weekly-reading').addEventListener('click', function(event) {
              event.preventDefault();
              // Переход на страницу статистики/таймера
              window.location.href = `../Timer/timer.html?type=timer`;
          });
          
      });
    </script>
</body>
</html>